Vendo API
Metadata

url: http://192.168.33.19/master/docs/developers/api/vendo-api
scraped_at: 2024-09-05T12:18:39.856789
last_updated: 2024-09-05T12:18:39.856821
parent_id: 21c021b76586e248072c806c95187f09
path: aPaczka Plugin/Dobre praktyki/Szkolenia - B2B/Zestawienie webinaria/Zestawienie eSzkolenia/Inter stal/Handel/Magazyn/Praca z czytnikiem/Rozliczenie produkcji/Ustawienia Przyjmowanie Towaru na pakowaniu/Laguna/Analizy/Okucia/Montan stal/Vendo API
meta_tags: ['usługa', 'można', 'port', 'netsh', 'http', 'vendo', 'usługi', 'https', 'vmargeca', 'host']

Content
Vendo API
Startowanie API jako usługa lokalna Vendo
W programie Vendo w oknie Usługi lokalne wybierając Usługa internetowego API -> Uruchom. Przed pierwszym uruchomieniem, należy skonfigurować ustawienia usługi API, można to zrobić w tym samym miejscu (przycisk ustawienia).
Startowanie API jako usługa w bocie
Aby uruchomić API w bocie Vendo, należy dodać do pliku konfiguracyjnego bota następujący wpis:
[ApiService]
Host=+
Port=5445
SSL=1
CheckOnlyProcess=0
LoggerEnabled=1
LoggerDirectory=D:\Api\Logi

Parametry :

Host - host uslugi (jesli nie podano, wtedy zostanie użyty host z ustawień usługi lokalnej),
Port - port uslugi (jesli nie podano, wtedy zostanie użyty port z ustawień usługi lokalnej),
SSL - czy usługa ma wykorzystywać https/ssl (0-nie, 1-tak),
CheckOnlyProcess - określa czy BotChecker w Vendo Starter ma sprawdzać jedynie czy process żyje, a nie czy API odpowiada (0-nie, 1-tak),
LoggerEnabled - czy zapisywać zapytania,
LoggerDirectory - katalog, do którego zostaną zapisane zapytania.

Rejestracja adresu w systemie
Do poprawnego działania API wymagana jest rejestracja adresu w systemie.
Można tego dokonać na dwa sposoby:

w programie Vendo w oknie Usługi lokalne wybierając Usługa internetowego API -> ustawienia (ikonka) -> Funkcje -> netsh add urlacl (zarejestrowany zostanie adres/port podany w tym okienu, w tym samym miejscu można usunąć dany adres);
bezpośrednio w konsoli systemowej uruchomionej z prawami administratora, używając polecenia:netsh http add urlacl url=https://+:5446/ user=MY-PC\User



Gdzie:
    * url - adres pod jakim ma być dostępna usługa API (musi zawierać port i protokuł http lub https),
    * user - użytkownik systemu windows zapisany w formacie [domena][nazwa użytkownika].
Konfiguracja SSL (https)
Do poprawnego działania API z użyciem SSL, wymagana jest rejestracja certyfikatu.
W tym celu, należy wykonać następujące polecenie w konsoli systemowej uruchomionej z prawami administratora:
netsh http add sslcert ipport=0.0.0.0:5446 certhash=59f9d7ba67fa42cd9c5507156084ad08c08cc0d6 appid={00112233-4455-6677-8899-AABBCCDDEEFF}

Gdzie:

certhash - hash certyfikatu SSL zarejestrowanego w systemie (można wygenerować własny lub użyć jednego z już istniejących certyfikatów - więcej szczegółów poniżej),
appid - ID aplikacji, w tym przypadku nie jest to istotne, można podać powyższy

Komendy pomocnicze
Wylistowanie zarejestrowanych adresów:
netsh http show urlacl

Jeżeli jakiś inny adres konfliktuje z naszym, to można go usunąc poleceniem (wymagana uprawnienia administratora):
netsh http delete urlacl https://+:5446/

Wylistowanie zarejestrowanych certyfikatyów SSL w systemie:
netsh http show sslcert

Generowanie własnego certyfikatu SSL


Use makecert.exe to create a certificate authority. Example:
makecert -n "CN=vMargeCA" -r -sv vMargeCA.pvk vMargeCA.cer



Use makecert.exe to create an SSL certificate
makecert -sk vMargeSignedByCA -iv vMargeCA.pvk -n "CN=vMargeSignedByCA" -ic vMargeCA.cer vMargeSignedByCA.cer -sr localmachine -ss My



Use MMC GUI to install CA in Trusted Authority store

Use MMC GUI to install ssl cert in Personal store
