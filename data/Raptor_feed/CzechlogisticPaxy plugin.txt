<style>
    redTxt { color: #ff0000; font-style: italic; }
    orangeTxt { color: #888; font-style: italic; }
</style>

# CzechlogisticPaxy plugin


## 1. Instalacja pluginu

Domyślna nazwa pluginu to: `SpedytorCzechlogisticPaxyPlugin.dll`

**Wgrywamy plugin do klienta.**

Kopiujemy plik z pluginem lokalnie na komputer. Uruchamiamy aplikację Vendo.
Przechodzimy do zakładki `Ustawienia -> Pluginy`. 

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/V1/2797d9f1f70571e2eb19399a6b738c99-28169-0.png)

Klikamy przycisk `Dodaj`. Dodajemy plugin znajdujący się na dysku lokalnym. Plugin zostaje dodany, można go wyszukać i zobaczyć jego status.

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/E6/0ba6bfe00126c822d5c22c07ec31f33d-46536-0.png)

Zamykamy okno z pluginami.


## 2. Konfiguracja ustawień w Vendo.

### 2.1. Konfiguracja połączenia ze spedytorem

Wchodzimy do zakładki `Ustawienia -> Główne -> Parametry pracy.`  

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/C4/ef6996722e16fdd5f174db6e9e6ab336-30057-0.png)

W zakładce `Logistyka -> Spedytorzy -> Ustawienia globalne` wyszukujemy plugin `CzechlogisticPaxy Plugin`, klikamy go i wprowadzamy następujące dane w polach:

> Klucz API: <redTxt>*[klucz dostępu do api]*</redTxt>

> Token: <redTxt>*[token]*</redTxt>

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/Z1/dfa6ac0309b26896a6a525cf96f00e52-30282-0.png)

Klucz i token należy wprowadzić aby system mógł prawidłowo komunikować się z API spedytora.

### 2.2. Dodajemy spedytora do słownika

Wchodzimy do zakładki `Ustawienia -> Główne -> Słowniki`

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/A2/3b1772055752ec86e72f1f4d1a7dc8a3-29943-0.png)

W sekcji `Logistyka` wyszukujemy pozycję `Spedycje`. 
Klikamy dwukrotnie na zaznaczonej pozycji. W nowo otwartym oknie wybieramy `Dodaj INSERT`.

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/H9/1a8528358edec82b3bb3fe0642fb81cb-49202-0.png)

Z listy rozwijanej `Shemat` wybieramy spedytora `CzechlogisticPaxy Plugin`. 
Następnie wprowadzamy dowolną nazwę w polu `Nazwa` np. *CzechlogisticPaxy*.
Poniżej znajdują się `Ustawienia`, w których możemy dodatkowo skonfigurować pozostałe parametry konfigurowalne. 
Zapisujemy i zamykamy okno.

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/L1/5cc15aa8924a8649008e9239ec61d052-52389-0.png)


### 2.3. Dodajemy pola użytkownika

Przy pierwszym eksporcie paczek plugin powinien automatycznie stworzyć poniższe wartości dowolne, ale jeżeli tak by się nie stało, należy dodać ręcznie.
W tym celu w liście tabel słownikowych w zakładce `Logistyka` wybieramy pozycję `Wartości dowolne wspólne logistyki`. Klikamy dwukrotnie na zaznaczonej pozycji. W nowo otwartym oknie `Lista wartości dowolnych` sprawdzamy czy istnieją dwa pola tekstowe (dwa wpisy):
> <redTxt>CZECH_LOGISTIC_BOOK_ID</redTxt>

> <redTxt>CZECH_LOGISTIC_COUNTRY</redTxt>

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/S6/4e90e0dd2d6a361a958368277633244b-52397-0.png)

Jeżeli nie ma tych pól dodajemy je po kolei, wybieramy `Funkcje -> Dodaj wartość dowolną -> Typy proste -> Tekst`. 
Następnie wprowadzamy dane w pola `Opis`, `Nazwa zmiennej`. 
Pole `Opis` może być dowolne, jest to tylko informacja dla użytkownika. Pole `Nazwa zmiennej` jest obowiązkowe i musi mieć jedną z dwóch wartości `CZECH_LOGISTIC_BOOK_ID` lub `CZECH_LOGISTIC_COUNTRY`.

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/J5/af39c9df3ae59ea5b653c2fb6f52f10e-31895-0.png)
![Image%201](https://www.cfi.pl/vendohelp/content/imgs/S0/18ccdb4147d0e1a2c6ac8e26b0cfe55f-31400-0.png)


Po zakończeniu dodawania tych pól zamykamy wszystkie otwarte okna i wychodzimy z konfiguracji.


## 3. Obsługa spedytora w listach przewozowych

W celu sprawdzenia działania spedytora CzechlogisticPaxy przechodzimy w Vendo do zakładki `Spedcyja -> Listy przewozowe`. 
Dodajemy nowy list przewozowy lub wybieramy istniejący z listy. Jeżeli chcemy edytować istniejący to filtrujemy listę, w polu `Spedycja` wybieramy pozycję `CzechlogisticPaxy`. Z listy dostępnych klikamy dwukrotnie na zaznaczonej pozycji.

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/Q4/cf539bee69a01962a76c719d6cd890b1-74041-0.png)

Zostaje otwarte okno z listem przewozowym. Wybieramy spedytora w polu `Spedytor`, a następnie usługę w polu `Usługa`. 
Kolejnym krokiem jest dodanie paczek w dolnej liście. Klikamy przycisk plus i dodajemy paczki. Paczki muszą być tego samego typu, jeżeli tak nie będzie zostanie zwrócony komunikat o błędzie.

![Image%201](https://www.cfi.pl/vendohelp/content/imgs/A4/b1500ebc7533470fbcb33d4a861f6627-42488-0.png)

Spedytor CzechlogisticPaxy obsługuje tylko wybrane kraje. Nie możemy obsłużyć spedytora dla kraju znajdującego sie poza listą w punkcie **4**. 
W dodatku musi zostać wybrana odpowiednia `Usługa` dla danego kraju. 
Przy dodawaniu paczki musi zostać wybrany odpowiedni `Typ paczki` dla danego kraju i wybranej wcześniej usługi. 
Jeżeli użytkownik wybierze nieprawidłowe powiązania `Kraj - Usługa - Typ paczki` to zostanie poinformowany stosownym komunikatem przy eksporcie paczek. 
Reasumując, `Typ paczki` jest ściśle powiązany z `Usługą` i `Kodem kraju (krajem)`. 
Cała lista możliwych kombinacji znajduje się w punkcie **4**.

## 4. Tabela: Kod kraju - Usługa - Typ paczki

Kraj | Kod kraju | Nazwa firmy kurierskiej | Usługa (carrierCode) | Typ paczki (Type)
-----|-----------|-------------------------|----------------------|------------------
Czechy | CZ | Poczta Czeska | poczta | parcel
Czechy | CZ | Poczta Czeska | poczta | baliknapostu
Czechy | CZ | Poczta Czeska | poczta | balikdobalikovny
Czechy | CZ | PPL | ppl | parcel
Czechy | CZ | WeDo | wedo | parcel
Czechy | CZ | FOFR | fofr | parcel
Czechy | CZ | GEIS | geis | pallet
Czechy | CZ | GEIS | geis | halfpallet
Czechy | CZ | Packeta CZ | zasielCz | point
Czechy | CZ | 123 Kuryr | 123kuryr | parcel
Słowacja | SK | 123 Kurier | 123kurier | parcel
Słowacja | SK | Packeta SK | zasielSk | point
Słowacja | SK | Poczta Słowacka | poczta | parcel
Węgry | HU | DPD | dpdhu | parcel
Węgry | HU | Sprinter | sprinter | parcel
Węgry | HU | PickPack | pickpack | parcel
Węgry | HU | Poczta Węgierska | mpl | parcel
Węgry | HU | GLS | glshu | parcel
Rumunia | RO | DPD | dpdro | paczka
Rumunia | RO | FanCourier | fancourier | parcel
Rumunia | RO | FanCourier | fancourier | point
Rumunia | RO | SameDay | sameday | point
Bułgaria | BG | Econt | econt | parcel
Bułgaria | BG | Econt | econt | office
Grecja | GR | Econt | econt | parcel
Chorwacja | HR | Overseas | overseas | parcel
Słowenia | SI | Pošta Slovenije | slovenije | parcel
Austria | AT | DPD | dpdat | parcel
Litwa | LT | LP Express | lpexpress | parcel
Litwa | LT | LP Express | lpexpress | point
Łotwa | LV | Latvijas Pasts | lpl | parcel
Estonia | EE | Omniva | omniva | parcel



## 5. Śledzenie statusu przesyłki

Spedytor wyróżnia następujące statusy przesyłek:

StatusCode | Status
-----------|-------
pending | w oczekiwaniu
scanned | zeskanowano
sent | wysłano
transport | w transporcie
delivery | w doręczeniu
point | w punkcie odbioru
delivered | doręczono
back | do zwrotu
unclaimed | nie odebrano