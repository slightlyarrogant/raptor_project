Trigger wyzwalany podczas ważenia
Metadata

url: http://192.168.33.19/master/docs/developers/interfejsy/scenariusze/trigger_weight
scraped_at: 2024-09-05T12:18:40.551350
last_updated: 2024-09-05T12:18:40.551376
parent_id: 21c021b76586e248072c806c95187f09
path: aPaczka Plugin/Dobre praktyki/Szkolenia - B2B/Zestawienie webinaria/Zestawienie eSzkolenia/Inter stal/Handel/Magazyn/Praca z czytnikiem/Rozliczenie produkcji/Ustawienia Przyjmowanie Towaru na pakowaniu/Laguna/Analizy/Okucia/Montan stal/Trigger wyzwalany podczas ważenia
meta_tags: ['jest', 'trigger', 'wagi', 'vptriggerweightexport', 'context', 'weight', 'przykład', 'wyzwalany', 'podczas', 'użycia']

Content
Trigger wyzwalany podczas ważenia
Trigger jest wyzwalany podczas użycia wagi w scenariuszach. Zakres jego użycia możemy określić, odpowiednio deklarując atrybut eksportowy.
Atrybut eksportowy:
VPTriggerWeightExport

W parametrze możemy podać scenariusz oraz stan w którym trigger się wyzwoli.
Przykłady:
VPTriggerWeightExport()

Tak zadeklarowany trigger zostanie wyzwolony na każdej formatce w każdym scenariuszu
VPTriggerWeightExport(typeof(ExecutionInProgressState), typeof(ExecutionInProgressScenario))

Tak zadeklarowany trigger zostanie wyzwolony tylko w scenariuszu ExecutionInProgressScenario i tylko na formatce ExecutionInProgressState
Interfejs:
VPTriggerWeight

Deklarując klasę triggera należy odziedziczyć z klasy abstrakcyjnej VPTriggerWeight
Konieczna jest implementacja metody Execute. Metoda to posiada parametr context który zawiera następujące informację:

decimal Weight - waga pobrana z urządzenia
JednostkaZnormalizowana Unit - jednostka w jakiej jest waga
IDT Dt - dt obiektu w kontekście którego następuje pomiar.

Dla produkcji start-stop jest to dt wykonania
Dla produkcji powykonawczej jest to dt operacji (nod)
Dla magazynówki jest to dt dokumentu
Kompletny przykład:
[VPTriggerWeightExport()]
    public class CorrectWeight : VPTriggerWeight
    {
        public override VPTriggerWeightReturn Execute(IVPTriggerWeightContext context)
        {
            return new VPTriggerWeightReturn
            {
                Weight = context.Weight * 2,
                Message = "Waga jest zawsze dwukrotnie zawyżona"
            };
        }
    }

Powyższy przykład spowoduje że każdy odczyt wagi będzie pomnożony przez 2. Dodatkowo operator dostanie stosowny komunikat. Powyższy przykład zadziała na wszystkich formatkach, wszystkich scenariuszy na których jest zaimplementowana obsługa wagi